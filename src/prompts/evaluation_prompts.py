"""
Prompts for evaluation (promise, completeness, relevance).
"""

PROMISE_EVALUATION_PROMPT = """# Задача оценки перспективности

Оцени, насколько **перспективно** следующее действие для достижения цели.

# Контекст
- **Запрос пользователя**: {query}
- **Уже собрано документов**: {collected_so_far}
- **Предложенное действие**: {proposed_action}
- **Объяснение**: {reasoning}

# Критерии оценки
1. **Релевантность** (0-1): насколько действие соответствует запросу
2. **Новизна** (0-1): принесет ли новую информацию (не дубликаты)
3. **Эффективность** (0-1): стоимость/польза (RAG лучше веба для базовых тем)
4. **Прогресс** (0-1): приблизит ли к цели (completeness 0.85)

# Формат ответа (JSON)
{{
  "promise_score": 0.85,  // Итоговая оценка 0-1
  "reasoning": "Это действие перспективно, потому что...",
  "breakdown": {{
    "relevance": 0.9,
    "novelty": 0.8,
    "efficiency": 0.9,
    "progress": 0.8
  }}
}}

Ответ (только JSON):"""


POST_EXECUTION_EVALUATION_PROMPT = """# Оценка после выполнения действия

Оцени результаты выполненного действия.

# Контекст
- **Запрос пользователя**: {query}
- **Всего собрано документов**: {total_docs}
- **Последние документы**:
{latest_docs_summary}

# Критерии оценки
1. **Completeness** (0-1): насколько полон материал для генерации
   - 0.0-0.3: очень мало информации
   - 0.3-0.6: есть базовая информация
   - 0.6-0.85: хорошая полнота, но можно улучшить
   - 0.85+: достаточно для отличного материала

2. **Relevance** (0-1): релевантность документов к запросу
   - Проверь, что документы действительно про запрошенную тему

3. **Quality** (0-1): качество документов
   - Читаемость, структура, наличие примеров/кода

4. **Should Continue**: продолжать ли поиск или хватит?

# Формат ответа (JSON)
{{
  "completeness_score": 0.75,
  "relevance_score": 0.88,
  "quality_score": 0.82,
  "should_continue": true,
  "reasoning": "Собрана базовая теория, но нужны примеры кода..."
}}

Ответ (только JSON):"""


HEURISTIC_COMPLETENESS_FORMULA = """
# Эвристическая формула для completeness (fallback)

completeness = min(1.0, (
    0.15 * num_documents +           # Базовая полнота от количества
    0.10 * avg_doc_length / 1000 +   # Учет объема
    0.20 * has_code_examples +       # Наличие кода
    0.15 * has_complexity_analysis + # Анализ сложности
    0.10 * has_diagrams              # Визуализация
))

Минимум для цели: 0.85
"""
