# ğŸ“ ĞĞ¸Ğ¡Ğ” Learning Platform v2: Ğ˜Ğ½Ñ‚ĞµĞ»Ğ»ĞµĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ° Ğ´Ğ»Ñ Ğ¸Ğ·ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ¾Ğ² Ğ¸ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

Ğ£Ñ‡ĞµĞ±Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚, Ğ´ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ¸Ñ€ÑƒÑÑ‰Ğ¸Ğ¹ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ **Ğ°Ğ³ĞµĞ½Ñ‚Ğ½Ñ‹Ñ… ÑĞ¸ÑÑ‚ĞµĞ¼ Ğ½Ğ° Ğ±Ğ°Ğ·Ğµ LLM** Ñ **Tree-of-Thoughts Ñ€Ğ°ÑÑÑƒĞ¶Ğ´ĞµĞ½Ğ¸ĞµĞ¼**, **Content Guards** Ğ¸ **Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹ Ğ·Ğ°Ñ‚Ñ€Ğ°Ñ‚** Ğ´Ğ»Ñ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ°Ğ¼ Ğ¸ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°Ğ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ….

---

## ğŸ§­ ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ğ¸Ğ´ĞµÑ

ĞŸÑ€Ğ¾ĞµĞºÑ‚ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·ÑƒĞµÑ‚ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ñ†ĞµĞ½Ğ½ÑƒÑ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½ÑƒÑ ÑĞºĞ¾ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ **FastAPI**, **LangChain**, **ReActĞ¸Ğ²Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´Ğ°** Ñ **Tree-of-Thoughts (ToT)**, **Adaptive/Corrective RAG**, **Web Search** Ğ¸ **Ğ´Ğ²ÑƒÑ… LLM-Ğ¿Ñ€Ğ¾Ğ²Ğ°Ğ¹Ğ´ĞµÑ€Ğ¾Ğ²** (GigaChat-2-Max Ğ´Ğ»Ñ ÑĞ»Ğ¾Ğ¶Ğ½Ğ¾Ğ³Ğ¾ reasoning, GigaChat3 Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹).

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸ v2:**

- ğŸ§  **Tree-of-Thoughts Orchestrator** Ñ DFS Ğ´Ğ»Ñ Ğ¸Ğ½Ñ‚ĞµĞ»Ğ»ĞµĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- ğŸ›¡ï¸ **Content Guard Layer** Ğ´Ğ»Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ñ‚Ğ¾ĞºÑĞ¸Ñ‡Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°
- ğŸ’° **Cost Optimization** Ñ‡ĞµÑ€ĞµĞ· Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹ (ÑĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ ~75%)
- ğŸ” **Adaptive RAG** Ñ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğ¼ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸ Ğ¿Ğ¾Ğ¸ÑĞºĞ° (TF-IDF, Semantic, Hybrid)
- âœ… **Corrective RAG** Ñ Ğ¾Ñ†ĞµĞ½ĞºĞ¾Ğ¹ Ñ€ĞµĞ»ĞµĞ²Ğ°Ğ½Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¸ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¾Ğ¹
- ğŸŒ **Web Search & Scraping** Ñ 4get metasearch Ğ¸ selectolax
- ğŸ§  **Procedural Memory** Ğ´Ğ»Ñ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ğ½Ğ° ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹Ñ… Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ğ°Ñ…
- ğŸ’¾ **Working Memory** Ğ´Ğ»Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ° ÑĞµÑÑĞ¸Ğ¸
- ğŸ”„ **Fallback Chains** Ğ´Ğ»Ñ ÑƒÑÑ‚Ğ¾Ğ¹Ñ‡Ğ¸Ğ²Ğ¾ÑÑ‚Ğ¸ Ğº ÑĞ±Ğ¾ÑĞ¼
- ğŸ“Š **Metrics & Monitoring** Ñ Prometheus-ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¼ ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ¼

---

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° v2

### High-Level Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     USER REQUEST                               â”‚
â”‚              {topic, user_level, user_id}                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   INPUT VALIDATION (GigaChat3)                       â”‚
    â”‚   - Prompt injection detection                       â”‚
    â”‚   - Format validation                                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   MEMORY LOADING (ChromaDB)                          â”‚
    â”‚   - Working Memory (session context)                 â”‚
    â”‚   - Procedural Memory (success patterns)             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ         ToT ORCHESTRATOR (GigaChat-2-Max)                â”ƒ
â”ƒ               ğŸ’° EXPENSIVE LAYER                         â”ƒ
â”ƒ                                                          â”ƒ
â”ƒ  THOUGHT â†’ ACTION â†’ OBSERVATION â†’ EVALUATION             â”ƒ
â”ƒ  ~5-7 iterations, DFS search                             â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
                         â”‚
                         â–¼
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ         TOOL LAYER (GigaChat3 Workers)                    â”ƒ
â”ƒ               ğŸ†“ FREE/CHEAP LAYER                          â”ƒ
â”ƒ                                                           â”ƒ
â”ƒ  -  Adaptive RAG Tool (strategy selection)                â”ƒ
â”ƒ  -  Corrective RAG Tool (relevance check)                 â”ƒ
â”ƒ  -  Web Search Tool (4get metasearch)                     â”ƒ
â”ƒ  -  Web Scraper Tool (content extraction)                 â”ƒ
â”ƒ  -  Concept Extractor Tool (KeyBERT, spaCy)               â”ƒ
â”ƒ  -  Memory Retrieval Tool (procedural patterns)           â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
                         â”‚
                         â–¼
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ      CONTENT GUARD LAYER (GigaChat3 Guards)              â”ƒ
â”ƒ               ğŸ›¡ï¸ SAFETY LAYER                            â”ƒ
â”ƒ                                                          â”ƒ
â”ƒ  1. Toxicity Check (batch processing)                    â”ƒ
â”ƒ  2. Policy Compliance Check                              â”ƒ
â”ƒ  3. Content Sanitization (rule-based)                    â”ƒ
â”ƒ  4. Quality Gate (length, sentences, content type)       â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
                         â”‚
                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   FINAL GENERATION (GigaChat-2-Max)                  â”‚
    â”‚   ğŸ’° Second expensive call                           â”‚
    â”‚   - Synthesize cleaned materials                      â”‚
    â”‚   - Apply user_level adaptation                       â”‚
    â”‚   - Generate 5000+ chars Markdown                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   PERSISTENCE & MEMORY UPDATE                        â”‚
    â”‚   - SQLite: MaterialGeneration record                 â”‚
    â”‚   - ChromaDB: Procedural Memory update                â”‚
    â”‚   - Working Memory: Clear session                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    RETURN RESPONSE
```

### Cost Optimization

| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚              | ĞœĞ¾Ğ´ĞµĞ»ÑŒ         | Ğ§Ğ°ÑÑ‚Ğ¾Ñ‚Ğ° Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ¾Ğ²       | ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ                  |
| ---------------------- | -------------- | --------------------- | --------------------------- |
| **ToT Orchestrator**   | GigaChat-2-Max | ~5-7 Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ¾Ğ²/Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ   | Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ¾Ğµ reasoning           |
| **Final Generation**   | GigaChat-2-Max | 1 Ğ²Ñ‹Ğ·Ğ¾Ğ²/Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ        | Ğ’Ñ‹ÑĞ¾ĞºĞ¾Ğµ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ğ°  |
| **Input Validation**   | GigaChat3      | 1 Ğ²Ñ‹Ğ·Ğ¾Ğ²/Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ        | Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°            |
| **Promise Evaluation** | GigaChat3      | ~15-20 Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ¾Ğ²/Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ | ĞÑ†ĞµĞ½ĞºĞ° Ğ¿ĞµÑ€ÑĞ¿ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸      |
| **Relevance Scoring**  | GigaChat3      | ~5-10 Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ¾Ğ²/Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ  | ĞšĞ»Ğ°ÑÑĞ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ñ€ĞµĞ»ĞµĞ²Ğ°Ğ½Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸ |
| **Content Guards**     | GigaChat3      | ~5-15 Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ¾Ğ²/Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ  | ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸       |
| **Completeness Check** | GigaChat3      | ~5-7 Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ¾Ğ²/Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ   | ĞÑ†ĞµĞ½ĞºĞ° Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ñ‚Ñ‹              |

**Ğ­ĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ: ~75%** Ğ¿Ğ¾ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ GigaChat-2-Max Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹.

---

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
src/
â”œâ”€â”€ agents/                         # ĞĞ³ĞµĞ½Ñ‚Ğ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° (LangChain)
â”‚   â”œâ”€â”€ orchestrator/               # Tree-of-Thoughts Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€
â”‚   â”‚   â”œâ”€â”€ workers/                # Ğ’Ğ¾Ñ€ĞºĞµÑ€Ñ‹ Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ñ‡
â”‚   â”‚   â”‚   â”œâ”€â”€ base_worker.py      # Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ ĞºĞ»Ğ°ÑÑ Ğ´Ğ»Ñ Ğ²Ğ¾Ñ€ĞºĞµÑ€Ğ¾Ğ²
â”‚   â”‚   â”‚   â”œâ”€â”€ materials_worker.py # Ğ’Ğ¾Ñ€ĞºĞµÑ€ Ğ´Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ğ°Ğ¼Ğ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ support_worker.py   # Ğ’Ğ¾Ñ€ĞºĞµÑ€ Ğ¿ÑĞ¸Ñ…Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ test_worker.py      # Ğ’Ğ¾Ñ€ĞºĞµÑ€ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ñ‚ĞµÑÑ‚Ğ¾Ğ²
â”‚   â”‚   â”‚   â””â”€â”€ verification_worker.py # Ğ’Ğ¾Ñ€ĞºĞµÑ€ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ²
â”‚   â”‚   â”œâ”€â”€ aggregator.py           # ĞĞ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ñ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² Ğ¾Ñ‚ Ğ²Ğ¾Ñ€ĞºĞµÑ€Ğ¾Ğ²
â”‚   â”‚   â”œâ”€â”€ classifier.py           # ĞšĞ»Ğ°ÑÑĞ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ¾Ğ²
â”‚   â”‚   â””â”€â”€ executor.py             # Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡ Ñ‡ĞµÑ€ĞµĞ· Ğ²Ğ¾Ñ€ĞºĞµÑ€Ğ¾Ğ²
â”‚   â”œâ”€â”€ chains/                     # LangChain Ñ†ĞµĞ¿Ğ¾Ñ‡ĞºĞ¸
â”‚   â”‚   â”œâ”€â”€ reasoning_chain.py      # Ğ¦ĞµĞ¿Ğ¾Ñ‡ĞºĞ° Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹ (ToT)
â”‚   â”‚   â”œâ”€â”€ evaluation_chain.py     # Ğ¦ĞµĞ¿Ğ¾Ñ‡ĞºĞ° Ğ¾Ñ†ĞµĞ½ĞºĞ¸ ÑƒĞ·Ğ»Ğ¾Ğ² (promise, completeness)
â”‚   â”‚   â””â”€â”€ output_parsers.py       # ĞŸĞ°Ñ€ÑĞµÑ€Ñ‹ Ğ´Ğ»Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°
â”‚   â”œâ”€â”€ content_guard/              # Content Guard ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
â”‚   â”‚   â”œâ”€â”€ orchestrator.py         # ĞÑ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€ Content Guard pipeline
â”‚   â”‚   â”œâ”€â”€ toxicity_checker.py     # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ‚Ğ¾ĞºÑĞ¸Ñ‡Ğ½Ğ¾ÑÑ‚Ğ¸ (GigaChat3)
â”‚   â”‚   â”œâ”€â”€ policy_checker.py       # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ñ Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°Ğ¼
â”‚   â”‚   â”œâ”€â”€ content_sanitizer.py    # Ğ¡Ğ°Ğ½Ğ¸Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ° (rule-based)
â”‚   â”‚   â””â”€â”€ quality_gate.py         # Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ°
â”‚   â”œâ”€â”€ input_validation_agent.py   # ĞĞ³ĞµĞ½Ñ‚ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸ Ğ²Ğ²Ğ¾Ğ´Ğ°
â”‚   â”œâ”€â”€ materials_agent.py          # ĞĞ³ĞµĞ½Ñ‚ Ğ´Ğ»Ñ Ğ°Ğ´Ğ°Ğ¿Ñ‚Ğ°Ñ†Ğ¸Ğ¸ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ğ¾Ğ² (legacy)
â”‚   â”œâ”€â”€ materials_agent_v2.py       # Materials Agent v2 Ñ ToT
â”‚   â”œâ”€â”€ llm_router_agent.py         # Ğ Ğ¾ÑƒÑ‚ĞµÑ€ Ğ´Ğ»Ñ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ° Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰ĞµĞ¹ LLM
â”‚   â”œâ”€â”€ support_agent.py            # ĞĞ³ĞµĞ½Ñ‚ Ğ¿ÑĞ¸Ñ…Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ¸
â”‚   â”œâ”€â”€ test_generation_agent.py    # ĞĞ³ĞµĞ½Ñ‚ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡
â”‚   â”œâ”€â”€ verification_agent.py       # ĞĞ³ĞµĞ½Ñ‚ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ² Ñ Ğ´Ğ²Ğ¾Ğ¹Ğ½Ğ¾Ğ¹ Ğ²ĞµÑ€Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸ĞµĞ¹
â”‚   â””â”€â”€ registry.py                 # Ğ ĞµĞµÑÑ‚Ñ€ Ğ²ÑĞµÑ… Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ²
â”œâ”€â”€ core/                           # Ğ¯Ğ´Ñ€Ğ¾ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹
â”‚   â”œâ”€â”€ cache/                      # ĞšĞµÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
â”‚   â”‚   â”œâ”€â”€ memory_cache.py         # In-memory LRU cache (fallback)
â”‚   â”‚   â””â”€â”€ redis_cache.py          # Redis cache (optional)
â”‚   â”œâ”€â”€ fallback/                   # Fallback ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸
â”‚   â”‚   â”œâ”€â”€ llm_fallback.py         # LLM fallback Ñ retry Ğ¸ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸ĞµĞ¼
â”‚   â”‚   â”œâ”€â”€ database_fallback.py    # Database fallback Ğ½Ğ° JSON
â”‚   â”‚   â””â”€â”€ chromadb_fallback.py    # ChromaDB fallback Ğ½Ğ° pickle
â”‚   â”œâ”€â”€ memory/                     # Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸
â”‚   â”‚   â”œâ”€â”€ memory_schemas.py       # Pydantic Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ Ğ´Ğ»Ñ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸
â”‚   â”‚   â”œâ”€â”€ working_memory.py       # Working Memory (ChromaDB + in-memory)
â”‚   â”‚   â””â”€â”€ procedural_memory.py    # Procedural Memory (ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹Ğµ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹)
â”‚   â”œâ”€â”€ database.py                 # SQLAlchemy Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ (User, Test, MaterialGeneration Ğ¸ Ğ´Ñ€.)
â”‚   â”œâ”€â”€ llm.py                      # LLMRouter Ğ´Ğ»Ñ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ° Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ Ğ¿Ğ¾ Ñ‚Ğ¸Ğ¿Ñƒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸
â”‚   â”œâ”€â”€ vector_store.py             # VectorStoreManager Ğ´Ğ»Ñ ChromaDB
â”‚   â””â”€â”€ memory_manager.py           # MemoryManager (unified interface)
â”œâ”€â”€ data_processing/                # ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ»Ñ RAG
â”‚   â”œâ”€â”€ db_populator.py             # Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ ChromaDB Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸ Ğ¸Ğ· PDF
â”‚   â”œâ”€â”€ pdf_parser.py               # ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ LaTeX-PDF Ñ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸ĞµĞ¼ Ğ¾Ğ³Ğ»Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ
â”‚   â””â”€â”€ text_splitter.py            # Ğ£Ğ¼Ğ½Ğ¾Ğµ Ñ€Ğ°Ğ·Ğ±Ğ¸ĞµĞ½Ğ¸Ğµ Ñ‚ĞµĞºÑÑ‚Ğ° Ğ½Ğ° Ñ‡Ğ°Ğ½ĞºĞ¸
â”œâ”€â”€ metrics/                        # ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¸ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³
â”‚   â”œâ”€â”€ analytics_service.py        # ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° ToT Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
â”‚   â”œâ”€â”€ deepeval_metrics.py         # DeepEval Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ°
â”‚   â”œâ”€â”€ health_service.py           # Health check ÑĞµÑ€Ğ²Ğ¸Ñ
â”‚   â”œâ”€â”€ metrics_collector.py        # Real-time Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ‚Ğ¾Ñ€
â”‚   â””â”€â”€ metrics_exporter.py         # Prometheus exporter
â”œâ”€â”€ models/                         # Pydantic-Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
â”‚   â”œâ”€â”€ schemas.py                  # Ğ¡Ñ…ĞµĞ¼Ñ‹ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ¸ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ² Ğ´Ğ»Ñ API
â”‚   â”œâ”€â”€ orchestrator_schemas.py     # Ğ¡Ñ…ĞµĞ¼Ñ‹ Ğ´Ğ»Ñ Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ° (legacy)
â”‚   â”œâ”€â”€ react_schemas.py            # Ğ¡Ñ…ĞµĞ¼Ñ‹ Ğ´Ğ»Ñ ToT (TreeNode, ToTResult)
â”‚   â””â”€â”€ content_guard_schemas.py    # Ğ¡Ñ…ĞµĞ¼Ñ‹ Ğ´Ğ»Ñ Content Guard
â”œâ”€â”€ prompts/                        # ĞŸÑ€Ğ¾Ğ¼Ğ¿Ñ‚Ñ‹ Ğ´Ğ»Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ²
â”‚   â”œâ”€â”€ validation_prompts.py       # ĞŸÑ€Ğ¾Ğ¼Ğ¿Ñ‚Ñ‹ Ğ´Ğ»Ñ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸
â”‚   â”œâ”€â”€ content_guard_prompts.py    # ĞŸÑ€Ğ¾Ğ¼Ğ¿Ñ‚Ñ‹ Ğ´Ğ»Ñ Content Guard
â”‚   â”œâ”€â”€ reasoning_prompts.py        # ĞŸÑ€Ğ¾Ğ¼Ğ¿Ñ‚Ñ‹ Ğ´Ğ»Ñ ToT reasoning
â”‚   â””â”€â”€ evaluation_prompts.py       # ĞŸÑ€Ğ¾Ğ¼Ğ¿Ñ‚Ñ‹ Ğ´Ğ»Ñ Ğ¾Ñ†ĞµĞ½ĞºĞ¸
â”œâ”€â”€ routers/                        # REST API Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹
â”‚   â”œâ”€â”€ assessment.py               # API Ğ¿ĞµÑ€Ğ²Ğ¸Ñ‡Ğ½Ğ¾Ğ¹ Ğ¾Ñ†ĞµĞ½ĞºĞ¸ Ğ·Ğ½Ğ°Ğ½Ğ¸Ğ¹
â”‚   â”œâ”€â”€ health.py                   # Healthcheck Ğ¸ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
â”‚   â”œâ”€â”€ llm_router.py               # API Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ° Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ LLM
â”‚   â”œâ”€â”€ materials.py                # API Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ğ¸ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ğ¾Ğ²
â”‚   â”œâ”€â”€ orchestrator.py             # API Ğ´Ğ»Ñ ĞºĞ¾Ğ¼Ğ¿Ğ»ĞµĞºÑĞ½Ñ‹Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
â”‚   â”œâ”€â”€ support.py                  # API Ğ¿ÑĞ¸Ñ…Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ¸
â”‚   â”œâ”€â”€ tests.py                    # API Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸ Ñ‚ĞµÑÑ‚Ğ¾Ğ²
â”‚   â””â”€â”€ verification.py             # API Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ²
â”œâ”€â”€ scripts/                        # Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹ Ğ¸ ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹
â”‚   â”œâ”€â”€ measure_secondary_verification.py # Ğ˜Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸Ğµ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ²ĞµÑ€Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸
â”‚   â”œâ”€â”€ populate_db.py              # CLI-ÑĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ´Ğ»Ñ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ ChromaDB
â”‚   â””â”€â”€ generate_endpoint_report.py # Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ° Ğ¿Ğ¾ API
â”œâ”€â”€ tools/                          # Tools Ğ´Ğ»Ñ Materials Agent v2
â”‚   â”œâ”€â”€ base_tool.py                # Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ ĞºĞ»Ğ°ÑÑ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… tools
â”‚   â”œâ”€â”€ adaptive_rag_tool.py        # Adaptive RAG Ñ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğ¼ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸
â”‚   â”œâ”€â”€ corrective_rag_tool.py      # Corrective RAG Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¾Ğ¹ Ñ€ĞµĞ»ĞµĞ²Ğ°Ğ½Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸
â”‚   â”œâ”€â”€ web_search_tool.py          # Web Search Ñ‡ĞµÑ€ĞµĞ· 4get
â”‚   â”œâ”€â”€ web_scraper_tool.py         # Web Scraper Ñ selectolax
â”‚   â”œâ”€â”€ concept_extractor_tool.py   # Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ğ¹ (KeyBERT, spaCy)
â”‚   â”œâ”€â”€ memory_retrieval_tool.py    # Retrieval Ğ¸Ğ· Procedural Memory
â”‚   â””â”€â”€ tool_registry.py            # Ğ ĞµĞµÑÑ‚Ñ€ tools Ñ lazy initialization
â”œâ”€â”€ utils/                          # Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹
â”‚   â”œâ”€â”€ logging_decorators.py       # Ğ”ĞµĞºĞ¾Ñ€Ğ°Ñ‚Ğ¾Ñ€Ñ‹ Ğ´Ğ»Ñ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
â”‚   â””â”€â”€ validators.py               # Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ‚Ğ¾Ñ€Ñ‹
â”œâ”€â”€ config.py                       # ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· Pydantic Settings
â”œâ”€â”€ exceptions.py                   # Custom exceptions
â””â”€â”€ main.py                         # Ğ¢Ğ¾Ñ‡ĞºĞ° Ğ²Ñ…Ğ¾Ğ´Ğ° FastAPI Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
```

---

## âš™ï¸ Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞº

### 1. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ uv

**uv** â€” ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¿Ğ°ĞºĞµÑ‚Ğ½Ñ‹Ğ¹ Ğ¼ĞµĞ½ĞµĞ´Ğ¶ĞµÑ€ Ğ´Ğ»Ñ Python, Ğ½Ğ°Ğ¿Ğ¸ÑĞ°Ğ½Ğ½Ñ‹Ğ¹ Ğ½Ğ° Rust (Ğ² 10x Ğ±Ñ‹ÑÑ‚Ñ€ĞµĞµ pip).

**Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° (Linux/macOS):**

```
curl -LsSf https://astral.sh/uv/install.sh | sh
```

**Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° (Windows):**

```
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
```

**Ğ˜Ğ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· pipx:**

```
pipx install uv
```

ĞÑ„Ğ¸Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ: [https://docs.astral.sh/uv/getting-started/installation/](https://docs.astral.sh/uv/getting-started/installation/)

### 2. ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚

```
git clone https://github.com/ZUB3C/dsa-learning-agent.git
cd dsa-learning-agent
```

### 3. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸

```
uv sync
```

Ğ­Ñ‚Ğ° ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ ÑĞ¾Ğ·Ğ´Ğ°ÑÑ‚ Ğ²Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ Ğ¸ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ Ğ²ÑĞµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¸Ğ· `pyproject.toml`.

### 4. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ `.env`

Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸:

```
cp .env.example .env
```

Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ API-ĞºĞ»ÑÑ‡Ğ¸ Ğ¸ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ² `.env` (ÑĞ¼. Ñ€Ğ°Ğ·Ğ´ĞµĞ» [ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ](#-ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ) Ğ½Ğ¸Ğ¶Ğµ).

### 5. Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ Ğ±Ğ°Ğ·Ñƒ Ğ·Ğ½Ğ°Ğ½Ğ¸Ğ¹ (ChromaDB)

Ğ’Ğ½Ğ°Ñ‡Ğ°Ğ»Ğµ Ğ½Ğ°Ğ´Ğ¾ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ñ„Ğ°Ğ¹Ğ» [algobook.pdf](https://www.babichev.org/books/AlgoBook.pdf) Ğ² ĞºĞ¾Ñ€ĞµĞ½ÑŒ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°.

**Ğ—Ğ°Ğ¿ÑƒÑĞº ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ° Ğ´Ğ»Ñ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ²ĞµĞºÑ‚Ğ¾Ñ€Ğ½Ğ¾Ğ¹ Ğ‘Ğ” Ğ¸Ğ· PDF:**

```
uv run python -m src.scripts.populate_db --pdf algobook.pdf --clear
```

**ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹:**

- `--pdf` â€” Ğ¿ÑƒÑ‚ÑŒ Ğº PDF Ñ„Ğ°Ğ¹Ğ»Ñƒ (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ: `algobook.pdf`)
- `--clear` â€” Ğ¾Ñ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ÑƒÑ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ Ğ¿ĞµÑ€ĞµĞ´ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸ĞµĞ¼
- `--chunk-size` â€” Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ Ñ‡Ğ°Ğ½ĞºĞ° Ğ² ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ°Ñ… (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ: 1000)
- `--chunk-overlap` â€” Ğ¿ĞµÑ€ĞµĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ Ñ‡Ğ°Ğ½ĞºĞ¾Ğ² (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ: 200)

### 6. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ (API)

```
uv run uvicorn src.main:app --reload --host 0.0.0.0 --port 8000
```

ĞÑ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Swagger UI:
ğŸ‘‰ [http://127.0.0.1:8001/docs](http://127.0.0.1:8001/docs)

### 7. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚Ğ° Ñ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ğ°Ğ¼Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ API

```
uv run python -m src.scripts.generate_endpoint_report
```

ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ÑÑ Ğ² Ñ„Ğ°Ğ¹Ğ» `api-examples-report.md`.

---

## ğŸ”§ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

ĞŸÑ€Ğ¾ĞµĞºÑ‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ **Pydantic Settings** Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸ĞµĞ¹ Ñ‡ĞµÑ€ĞµĞ· `.env` Ñ„Ğ°Ğ¹Ğ».

### ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸

```
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# LLM CONFIGURATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# GigaChat API Settings
GIGACHAT_API_KEY=your_api_key_here
GIGACHAT_BASE_URL=https://foundation-models.api.cloud.ru/v1

# GigaChat-2-Max (expensive, for ToT Orchestrator)
GIGACHAT_MODEL=GigaChat/GigaChat-2-Max
GIGACHAT_TEMPERATURE=0.2

# GigaChat3 (cheap, for tools and guards)
GIGACHAT3_MODEL=ai-sage/GigaChat3-10B-A1.8B
GIGACHAT3_TEMPERATURE=0.1

# ChromaDB
CHROMA_PERSIST_DIRECTORY=.chromadb
CHROMA_RAG_COLLECTION=aisd_materials

# Database
DATABASE_URL=sqlite+aiosqlite:///./app.db
```

---

## ğŸ§© API Endpoints

### System

| ĞœĞµÑ‚Ğ¾Ğ´ | Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚           | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ                                |
| ----- | ------------------ | --------------------------------------- |
| `GET` | `/health`          | ĞŸÑ€Ğ¾ÑÑ‚Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ              |
| `GET` | `/health/detailed` | Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ health check Ğ²ÑĞµÑ… ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ² |
| `GET` | `/metrics`         | Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ (Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¹ Ñ‡Ğ°Ñ)       |

### Materials (v2 Ñ ToT)

| ĞœĞµÑ‚Ğ¾Ğ´  | Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚                              | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ                                       |
| ------ | ------------------------------------- | ---------------------------------------------- |
| `POST` | `/api/v1/materials/generate-material` | **Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ğ° Ñ‡ĞµÑ€ĞµĞ· ToT Orchestrator** |
| `POST` | `/api/v1/materials/get-materials`     | ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ°Ğ´Ğ°Ğ¿Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ñ‹              |
| `POST` | `/api/v1/materials/ask-question`      | Ğ—Ğ°Ğ´Ğ°Ñ‚ÑŒ Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ Ğ¿Ğ¾ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ñƒ                     |
| `GET`  | `/api/v1/materials/topics`            | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… Ñ‚ĞµĞ¼                           |
| `POST` | `/api/v1/materials/search`            | ĞŸĞ¾Ğ¸ÑĞº Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ğ¾Ğ²                               |

### Assessment

| ĞœĞµÑ‚Ğ¾Ğ´  | Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚                               | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ                          |
| ------ | -------------------------------------- | --------------------------------- |
| `POST` | `/api/v1/assessment/start`             | ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ¿ĞµÑ€Ğ²Ğ¸Ñ‡Ğ½Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ     |
| `POST` | `/api/v1/assessment/submit`            | ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ |
| `GET`  | `/api/v1/assessment/results/{user_id}` | ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¾Ñ†ĞµĞ½ĞºĞ¸        |

### Tests

| ĞœĞµÑ‚Ğ¾Ğ´  | Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚                                | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ                   |
| ------ | --------------------------------------- | -------------------------- |
| `POST` | `/api/v1/tests/generate`                | Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ‚ĞµÑÑ‚ Ğ¿Ğ¾ Ñ‚ĞµĞ¼Ğµ |
| `POST` | `/api/v1/tests/generate-task`           | Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ       |
| `POST` | `/api/v1/tests/submit-for-verification` | ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚ Ğ½Ğ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºÑƒ |
| `GET`  | `/api/v1/tests/{test_id}`               | ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚ Ğ¿Ğ¾ ID        |

### Verification

| ĞœĞµÑ‚Ğ¾Ğ´  | Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚                                 | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ                               |
| ------ | ---------------------------------------- | -------------------------------------- |
| `POST` | `/api/v1/verification/check-test`        | ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° Ñ Ğ´Ğ²Ğ¾Ğ¹Ğ½Ğ¾Ğ¹ Ğ²ĞµÑ€Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸ĞµĞ¹ |
| `GET`  | `/api/v1/verification/history/{user_id}` | Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¾Ğº Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ          |

### Support

| ĞœĞµÑ‚Ğ¾Ğ´  | Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚                      | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ                           |
| ------ | ----------------------------- | ---------------------------------- |
| `POST` | `/api/v1/support/get-support` | ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¿ÑĞ¸Ñ…Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºÑƒÑ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºÑƒ |
| `GET`  | `/api/v1/support/resources`   | Ğ ĞµÑÑƒÑ€ÑÑ‹ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ¸                  |

---

## ğŸ§  ĞĞ³ĞµĞ½Ñ‚Ğ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° v2

### Tree-of-Thoughts Orchestrator

**Ğ¤Ğ°Ğ¹Ğ»:** `src/agents/materials_agent_v2.py`

Ğ¦ĞµĞ½Ñ‚Ñ€Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€, Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‰Ğ¸Ğ¹ **DFS (Depth-First Search)** Ğ´Ğ»Ñ Ğ¸ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ´ĞµÑ€ĞµĞ²Ğ° Ñ€Ğ°ÑÑÑƒĞ¶Ğ´ĞµĞ½Ğ¸Ğ¹.

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¾ÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸:**

- Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ĞºĞ°Ğ½Ğ´Ğ¸Ğ´Ğ°Ñ‚Ğ½Ñ‹Ñ… Ğ¼Ñ‹ÑĞ»ĞµĞ¹ Ğ½Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ ÑˆĞ°Ğ³Ğµ (GigaChat-2-Max)
- ĞÑ†ĞµĞ½ĞºĞ° Ğ¿ĞµÑ€ÑĞ¿ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ (promise score) Ñ‡ĞµÑ€ĞµĞ· GigaChat3
- Pruning Ğ½Ğ¸Ğ·ĞºĞ¾Ğ¿ĞµÑ€ÑĞ¿ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ²ĞµÑ‚Ğ¾Ğº
- Post-execution evaluation (completeness, relevance, quality)
- Backtracking Ğ¿Ñ€Ğ¸ Ñ‚ÑƒĞ¿Ğ¸ĞºĞ°Ñ…
- Ğ¦ĞµĞ»ÑŒ: completeness â‰¥ 0.85

### Tools (Ğ²ÑĞµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚ GigaChat3)

| Tool                  | Ğ¤Ğ°Ğ¹Ğ»                        | ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ                                        |
| --------------------- | --------------------------- | ------------------------------------------------- |
| **Adaptive RAG**      | `adaptive_rag_tool.py`      | Ğ’Ñ‹Ğ±Ğ¾Ñ€ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸ Ğ¿Ğ¾Ğ¸ÑĞºĞ° (TF-IDF, Semantic, Hybrid) |
| **Corrective RAG**    | `corrective_rag_tool.py`    | ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€ĞµĞ»ĞµĞ²Ğ°Ğ½Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¸ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°    |
| **Web Search**        | `web_search_tool.py`        | ĞŸĞ¾Ğ¸ÑĞº Ñ‡ĞµÑ€ĞµĞ· 4get metasearch engine                |
| **Web Scraper**       | `web_scraper_tool.py`       | Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ° Ñ Ğ²ĞµĞ±-ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†                 |
| **Concept Extractor** | `concept_extractor_tool.py` | Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ğ¹ (KeyBERT, spaCy)             |
| **Memory Retrieval**  | `memory_retrieval_tool.py`  | Retrieval ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹Ñ… Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ğ¾Ğ²                      |

### Content Guard Components (GigaChat3)

| Component             | Ğ¤Ğ°Ğ¹Ğ»                   | ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ                                  |
| --------------------- | ---------------------- | ------------------------------------------- |
| **Toxicity Checker**  | `toxicity_checker.py`  | Batch Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ‚Ğ¾ĞºÑĞ¸Ñ‡Ğ½Ğ¾ÑÑ‚Ğ¸                  |
| **Policy Checker**    | `policy_checker.py`    | ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ñ Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°Ğ¼ GigaChat    |
| **Content Sanitizer** | `content_sanitizer.py` | Rule-based ÑĞ°Ğ½Ğ¸Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (HTML, URLs, emails) |
| **Quality Gate**      | `quality_gate.py`      | Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ°                 |

### Chains

| Chain                | Ğ¤Ğ°Ğ¹Ğ»                  | ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ                                      |
| -------------------- | --------------------- | ----------------------------------------------- |
| **Reasoning Chain**  | `reasoning_chain.py`  | Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¼Ñ‹ÑĞ»ĞµĞ¹ Ğ² ToT (GigaChat-2-Max)         |
| **Evaluation Chain** | `evaluation_chain.py` | ĞÑ†ĞµĞ½ĞºĞ° ÑƒĞ·Ğ»Ğ¾Ğ²: promise, completeness (GigaChat3) |

### Legacy Agents

| ĞĞ³ĞµĞ½Ñ‚               | Ğ¤Ğ°Ğ¹Ğ»                       | ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ                              |
| ------------------- | -------------------------- | --------------------------------------- |
| **Materials Agent** | `materials_agent.py`       | ĞĞ´Ğ°Ğ¿Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ğ¾Ğ² (legacy, Ğ±ĞµĞ· ToT)  |
| **LLM Router**      | `llm_router_agent.py`      | Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰ĞµĞ¹ LLM Ğ¿Ğ¾ ÑĞ·Ñ‹ĞºÑƒ           |
| **Support Agent**   | `support_agent.py`         | ĞŸÑĞ¸Ñ…Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ°               |
| **Test Generation** | `test_generation_agent.py` | Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡                |
| **Verification**    | `verification_agent.py`    | ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ² Ñ Ğ´Ğ²Ğ¾Ğ¹Ğ½Ğ¾Ğ¹ Ğ²ĞµÑ€Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸ĞµĞ¹ |

---

## ğŸ”¬ Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑÑ‚ĞµĞº

- **Backend:** FastAPI + Uvicorn
- **LLM Orchestration:** LangChain
- **LLM Providers:** [GigaChat-2-Max](https://giga.chat) (expensive) + [GigaChat3-10B](https://huggingface.co/ai-sage/GigaChat3-10B-A1.8B) (cheap)
- **Vector Database:** ChromaDB + HuggingFace Embeddings
- **Relational Database:** SQLite (SQLAlchemy ORM, async)
- **PDF Processing:** PyMuPDF (Ğ´Ğ»Ñ Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³Ğ° LaTeX-PDF)
- **Web Scraping:** aiohttp + selectolax
- **Web Search:** 4get metasearch engine
- **Concept Extraction:** KeyBERT + spaCy
- **Caching:** Redis (optional) + in-memory LRU
- **Metrics:** Prometheus-compatible exporter
- **Package Manager:** uv
- **Task Runner:** just

---

## ğŸ“Š ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¸ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³

### Prometheus Metrics

Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚: `/metrics` (Prometheus text format)

**Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸:**

- `materials_agent_requests_total` - Ğ’ÑĞµĞ³Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
- `materials_agent_requests_successful_total` - Ğ£ÑĞ¿ĞµÑˆĞ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
- `materials_agent_response_time_avg` - Ğ¡Ñ€ĞµĞ´Ğ½ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°
- `materials_agent_llm_calls_total{model}` - LLM Ğ²Ñ‹Ğ·Ğ¾Ğ²Ñ‹ Ğ¿Ğ¾ Ğ¼Ğ¾Ğ´ĞµĞ»ÑĞ¼
- `materials_agent_cost_total` - ĞĞ±Ñ‰Ğ°Ñ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ (USD)
- `materials_agent_tool_calls_total{tool}` - Tool Ğ²Ñ‹Ğ·Ğ¾Ğ²Ñ‹
- `materials_agent_documents_filtered_total` - ĞÑ‚Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²

### Database Metrics

**Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° `material_generations`:**

- ToT Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ (iterations, explored_nodes, dead_end_nodes, best_path_depth)
- Tool usage (tools_used, tool_call_counts)
- LLM usage (gigachat2_max_calls, gigachat3_calls, estimated_cost_usd)
- Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ (success, final_completeness_score, documents_collected)
- ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ (generation_time_seconds)

**Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° `tot_node_logs`:**

- Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ»Ğ¾Ğ³Ğ¸ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ÑƒĞ·Ğ»Ğ° ToT
- Scores (promise_score, completeness_score, relevance_score, quality_score)
- Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ ÑƒĞ·Ğ»Ğ° (pending, executing, promising, dead_end, goal_reached)

**Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° `content_guard_logs`:**

- Ğ›Ğ¾Ğ³Ğ¸ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
- Toxicity scores, policy compliance, quality checks

### Analytics API

**Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚:** `/api/v1/analytics/generation-stats`

ĞĞ³Ñ€ĞµĞ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸ÑĞ¼:

- Success rate
- Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹ completeness score
- Ğ¡Ñ€ĞµĞ´Ğ½ĞµĞµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¸Ñ‚ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
- Ğ¡Ñ€ĞµĞ´Ğ½ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
- ĞĞ±Ñ‰Ğ°Ñ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ
- Tool usage distribution

---

## ğŸ”„ Fallback Chains

Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° ÑƒÑÑ‚Ğ¾Ğ¹Ñ‡Ğ¸Ğ²Ğ° Ğº ÑĞ±Ğ¾ÑĞ¼ Ğ±Ğ»Ğ°Ğ³Ğ¾Ğ´Ğ°Ñ€Ñ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ñ‹Ğ¼ fallback ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸ÑĞ¼:

### LLM Fallback

1. **Primary:** GigaChat-2-Max/GigaChat3
2. **Retry:** Exponential backoff (3 Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ¸)
3. **Fallback:** Rule-based heuristics
4. **Last resort:** Cached response (ĞµÑĞ»Ğ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½)

### Database Fallback

1. **Primary:** SQLite (async)
2. **Fallback:** JSON Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ² `./backups/generations/`
3. **Recovery:** ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğ¸ Ğ‘Ğ”

### ChromaDB Fallback

1. **Primary:** ChromaDB
2. **Fallback:** Pickle Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ² `./data/fallback/chromadb/`
3. **Search:** Keyword-based matching (Jaccard similarity)

### Content Guard Fallback

1. **Primary:** GigaChat3 batch check
2. **Fallback:** Individual checks
3. **Last resort:** Rule-based filter (blacklist words, patterns)
4. **Default:** Assume safe (log warning for manual review)

---

## ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°

### Pre-commit Hooks

```
uv tool install pre-commit --with pre-commit-uv --force-reinstall
uv tool run pre-commit install
```

### Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ´Ğ°

ĞŸÑ€Ğ¾ĞµĞºÑ‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ **just** Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡.

**Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° just:**

```
# macOS
brew install just

# Linux
cargo install just

# Windows
scoop install just
```

**Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**

```
just format
```

### Ğ˜Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸Ğµ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ²ĞµÑ€Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸

```
uv run python -m src.scripts.measure_secondary_verification --test-data test_data.json
```

---

## ğŸ“– ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

### Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ğ° Ñ‡ĞµÑ€ĞµĞ· ToT

```
import requests

response = requests.post(
    "http://localhost:8001/api/v1/materials/generate-material",
    json={
        "user_id": "user123",
        "topic": "Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°",
        "user_level": "intermediate"
    }
)

result = response.json()

print(f"Material: {result['material'][:500]}...")
print(f"ToT Iterations: {result['metadata']['tot_iterations']}")
print(f"Documents Collected: {result['metadata']['documents_collected']}")
print(f"Tools Used: {result['metadata']['tools_used']}")
print(f"Completeness: {result['metadata']['final_completeness']}")
print(f"Cost: ${result['metadata']['estimated_cost_usd']:.4f}")
```

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒÑ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

```
response = requests.get("http://localhost:8001/health/detailed")
health = response.json()

print(f"Overall Status: {health['status']}")
print(f"GigaChat-2-Max: {health['components']['gigachat2_max']['status']}")
print(f"GigaChat3: {health['components']['gigachat3']['status']}")
print(f"ChromaDB: {health['components']['chromadb']['status']}")
```

### ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ñ‹

Ğ’ÑĞµ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ API Ğ½Ğ°Ñ…Ğ¾Ğ´ÑÑ‚ÑÑ Ğ² Ñ„Ğ°Ğ¹Ğ»Ğµ [api-examples-report.md](api-examples-report.md)

---

## ğŸ¤ Ğ’ĞºĞ»Ğ°Ğ´ Ğ² Ğ¿Ñ€Ğ¾ĞµĞºÑ‚

ĞŸÑ€Ğ¾ĞµĞºÑ‚ ÑĞ¾Ğ·Ğ´Ğ°Ğ½ Ğ² ÑƒÑ‡ĞµĞ±Ğ½Ñ‹Ñ… Ñ†ĞµĞ»ÑÑ… Ğ´Ğ»Ñ Ğ´ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾Ğ´Ğ²Ğ¸Ğ½ÑƒÑ‚Ñ‹Ñ… Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ğ¾Ğ² Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ LLM.

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹:**

- Tree-of-Thoughts reasoning
- Cost optimization Ñ‡ĞµÑ€ĞµĞ· Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹
- Content safety Ñ‡ĞµÑ€ĞµĞ· multi-stage guards
- Adaptive/Corrective RAG
- Procedural memory Ğ´Ğ»Ñ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ğ½Ğ° Ğ¾Ğ¿Ñ‹Ñ‚Ğµ
- Fallback chains Ğ´Ğ»Ñ ÑƒÑÑ‚Ğ¾Ğ¹Ñ‡Ğ¸Ğ²Ğ¾ÑÑ‚Ğ¸

---

## ğŸ“„ Ğ›Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸Ñ

ĞŸÑ€Ğ¾Ğ¿Ñ€Ğ¸ĞµÑ‚Ğ°Ñ€Ğ½Ğ°e ĞŸĞ.

---

**Ğ’ĞµÑ€ÑĞ¸Ñ:** 2.0.0
**Ğ”Ğ°Ñ‚Ğ° Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ:** Ğ”ĞµĞºĞ°Ğ±Ñ€ÑŒ 2025
